{% extends 'base.html' %}

{% block title %}
    –ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="/static/css/report/add-report.css">
{% endblock %}

{% block body %}
<div class="container mt-3">
    <h1 class="text-center mb-4">–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</h1>

    <div class="upload-section">
        <p class="text-center mb-3">–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ –∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—é</p>
        <div class="text-center" id="upload-button-container">
            <label for="fileInput" class="upload-photo-btn">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 5h6"/>
                    <path d="M19 2v6"/>
                    <path d="M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5"/>
                    <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
                    <circle cx="9" cy="9" r="2"/>
                </svg>
            </label>
            <button type="button" id="fallback-upload-btn" style="display: none; margin-top: 10px; padding: 10px 20px;">
                üì∑ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ
            </button>
            <input type="file" id="fileInput" multiple accept=".jpg,.jpeg,.png" style="display: none;">
        </div>
    </div>

    <div id="preview-container" class="mt-3">
        <div class="preview-header">
            <h4>–í—ã –≤—ã–±—Ä–∞–ª–∏ (<span id="photo-count">0</span>/5):</h4>
        </div>
        <div id="image-previews" class="d-flex flex-wrap"></div>
    </div>

    <div class="form-container mt-4">
        <div class="form-group mb-4">
            <div class="dropdown mt-3">
                <button class="btn btn-primary dropdown-toggle" type="button" id="reportDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    –í—ã–±–µ—Ä–∏ –ø–∏—Ç–æ–º—Ü–∞
                </button>
                <ul class="dropdown-menu" aria-labelledby="reportDropdown">
                    {% for pet in pet_list %}
                        <li>
                            <a class="dropdown-item" href="#" data-pet-id="{{ pet.id }}">
                                {{ pet.name }} -- {{ pet.breed }} -- {{ pet.id }}
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            <div>
                <label for="reportTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                <input type="text" class="form-control" id="reportTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—è">
                <div id="error-reportTitle" class="error-message"></div>
            </div>
            <div>
                <label for="reportContent">–û–±—ä—è–≤–ª–µ–Ω–∏–µ</label>
                <textarea class="form-control" id="reportContent" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è" rows="5"></textarea>
                <div id="error-reportContent" class="error-message"></div>
            </div>
        </div>

        <div class="text-center mt-4">
            <div id="spinner" class="spinner"></div>
            <button type="button" id="submit-btn" class="btn btn-primary" disabled>–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="/static/js/addReport.js"></script>
{% endblock %}

{% block tg_button %}
    <script src="/static/js/backButtonController.js"></script>
    <script>
        setupBackButton(true, '/reports');
    </script>
{% endblock %}

{% block footer %}
    {% include "components/footer.html" %}
{% endblock %}